using more function and nested loops
